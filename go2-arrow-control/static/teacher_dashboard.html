<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Teacher Dashboard</h1>
            <a href="{{ url_for('teacher_logout') }}" class="btn btn-danger" style="float:right">Logout</a>
        </header>

        <div class="main-content">
            <h3>Settings</h3>
            <form id="teacher-settings-form" method="post" action="{{ url_for('teacher_update_settings') }}">
                <div class="form-group">
                    <label for="confidence_threshold">Confidence Threshold (0-1):</label>
                    <input type="number" step="0.01" min="0" max="1" id="confidence_threshold" name="confidence_threshold" value="{{ settings.confidence_threshold }}">
                </div>
                <div class="form-group">
                    <label for="max_speed">Max Speed:</label>
                    <input type="number" step="0.01" min="0" max="1" id="max_speed" name="max_speed" value="{{ settings.max_speed }}">
                </div>
                <div class="form-group">
                    <label for="command_interval">Command Interval (seconds):</label>
                    <input type="number" step="0.1" min="0" id="command_interval" name="command_interval" value="{{ settings.command_interval }}">
                </div>
                <div class="form-group">
                    <label for="buffer_size">Buffer Size (frames):</label>
                    <input type="number" min="1" id="buffer_size" name="buffer_size" value="{{ settings.buffer_size }}">
                </div>
                <div class="form-group">
                    <label for="consensus_required">Consensus Required (frames):</label>
                    <input type="number" min="1" id="consensus_required" name="consensus_required" value="{{ settings.consensus_required }}">
                </div>

                <button type="submit" class="btn btn-primary">Save Settings</button>
            </form>

            <div id="result" style="margin-top:10px"></div>
        </div>
    </div>

    <script>
    document.getElementById('teacher-settings-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target;
        const formData = new FormData(form);
        const data = {};
        for (const [k,v] of formData.entries()) data[k]=v;

        const resp = await fetch(form.action, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        const json = await resp.json();
        const result = document.getElementById('result');
        if (json.success) {
            result.textContent = 'Settings saved âœ“';
            result.style.color = 'green';
        } else {
            result.textContent = 'Error: ' + (json.error || 'unknown');
            result.style.color = 'red';
        }
    });
    </script>
</body>
</html>
